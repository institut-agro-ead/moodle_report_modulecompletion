{"version":3,"file":"reports.min.js","sources":["../src/reports.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Registers events to opn/close reports results.\n *\n * @copyright  2023 L’Institut Agro Enseignement à distance\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nconst registerEventListeners = () => {\n  const changeBtn = (button, collapsed) => {\n    button.dataset.collapsed = !collapsed;\n    button.setAttribute(\"aria-expanded\", collapsed);\n    button.querySelector(\"span\").textContent =\n      button.dataset[collapsed ? \"buttonTextHide\" : \"buttonTextShow\"];\n    if (collapsed) {\n      button.querySelector(\"i\").classList.remove(\"fa-chevron-down\");\n      button.querySelector(\"i\").classList.add(\"fa-chevron-up\");\n    } else {\n      button.querySelector(\"i\").classList.add(\"fa-chevron-down\");\n      button.querySelector(\"i\").classList.remove(\"fa-chevron-up\");\n    }\n  };\n\n  const changeContent = (content, collapsed) => {\n    if (\n      (collapsed && content.classList.contains(\"open\")) ||\n      (!collapsed && !content.classList.contains(\"open\"))\n    ) {\n      return;\n    }\n    content.classList[collapsed ? \"add\" : \"remove\"](\"open\");\n    content.setAttribute(\"aria-expanded\", collapsed);\n    const height = content.querySelector(\"div\").offsetHeight;\n    const hidableParent = content.closest(\n      \".hidable_content.hidable_content_higher_container\"\n    );\n    content.style.height = collapsed ? height + \"px\" : 0;\n    if (hidableParent && hidableParent !== content) {\n      const parentCurrentHeight = Number(\n        hidableParent.style.height.slice(0, -2)\n      );\n      if (collapsed) {\n        hidableParent.style.height = parentCurrentHeight + height + \"px\";\n      } else {\n        hidableParent.style.height =\n          (parentCurrentHeight - height < 0\n            ? 0\n            : parentCurrentHeight - height) + \"px\";\n      }\n    }\n  };\n\n  document.querySelectorAll(\".show_hide_all_trigger\").forEach((btn) => {\n    const container = btn.closest(\".hidable_content_higher_container\");\n\n    btn.addEventListener(\"click\", () => {\n      const collapsed = btn.dataset.collapsed === \"true\";\n      if (btn.dataset.showAllChildren) {\n        container\n          .querySelectorAll(\".show_hide_all_trigger\")\n          .forEach((b) => changeBtn(b, collapsed));\n        container\n          .querySelectorAll(\".hidable_content\")\n          .forEach((c) => changeContent(c, collapsed));\n      } else {\n        changeBtn(btn, collapsed);\n        changeContent(container.querySelector(\".hidable_content\"), collapsed);\n      }\n    });\n  });\n};\n\nexport const init = () => {\n  registerEventListeners();\n};\n"],"names":["changeBtn","button","collapsed","dataset","setAttribute","querySelector","textContent","classList","remove","add","changeContent","content","contains","height","offsetHeight","hidableParent","closest","style","parentCurrentHeight","Number","slice","document","querySelectorAll","forEach","btn","container","addEventListener","showAllChildren","b","c","registerEventListeners"],"mappings":"oKAsFoB,KAhEW,YACvBA,UAAY,CAACC,OAAQC,aACzBD,OAAOE,QAAQD,WAAaA,UAC5BD,OAAOG,aAAa,gBAAiBF,WACrCD,OAAOI,cAAc,QAAQC,YAC3BL,OAAOE,QAAQD,UAAY,iBAAmB,kBAC5CA,WACFD,OAAOI,cAAc,KAAKE,UAAUC,OAAO,mBAC3CP,OAAOI,cAAc,KAAKE,UAAUE,IAAI,mBAExCR,OAAOI,cAAc,KAAKE,UAAUE,IAAI,mBACxCR,OAAOI,cAAc,KAAKE,UAAUC,OAAO,mBAIzCE,cAAgB,CAACC,QAAST,gBAE3BA,WAAaS,QAAQJ,UAAUK,SAAS,UACvCV,YAAcS,QAAQJ,UAAUK,SAAS,eAI7CD,QAAQJ,UAAUL,UAAY,MAAQ,UAAU,QAChDS,QAAQP,aAAa,gBAAiBF,iBAChCW,OAASF,QAAQN,cAAc,OAAOS,aACtCC,cAAgBJ,QAAQK,QAC5B,wDAEFL,QAAQM,MAAMJ,OAASX,UAAYW,OAAS,KAAO,EAC/CE,eAAiBA,gBAAkBJ,QAAS,OACxCO,oBAAsBC,OAC1BJ,cAAcE,MAAMJ,OAAOO,MAAM,GAAI,IAGrCL,cAAcE,MAAMJ,OADlBX,UAC2BgB,oBAAsBL,OAAS,MAGzDK,oBAAsBL,OAAS,EAC5B,EACAK,oBAAsBL,QAAU,OAK5CQ,SAASC,iBAAiB,0BAA0BC,SAASC,YACrDC,UAAYD,IAAIR,QAAQ,qCAE9BQ,IAAIE,iBAAiB,SAAS,WACtBxB,UAAsC,SAA1BsB,IAAIrB,QAAQD,UAC1BsB,IAAIrB,QAAQwB,iBACdF,UACGH,iBAAiB,0BACjBC,SAASK,GAAM5B,UAAU4B,EAAG1B,aAC/BuB,UACGH,iBAAiB,oBACjBC,SAASM,GAAMnB,cAAcmB,EAAG3B,eAEnCF,UAAUwB,IAAKtB,WACfQ,cAAce,UAAUpB,cAAc,oBAAqBH,mBAOjE4B"}